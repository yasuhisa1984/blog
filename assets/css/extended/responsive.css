/* ブログ全体のレスポンシブ対応CSS */

/* ==========================================================================
   記事コンテンツの基本レイアウト
   ========================================================================== */

.post-content {
  /* すべての子要素を縦並びに */
  display: flex;
  flex-direction: column;
  gap: 0;
}

/* ==========================================================================
   Mermaid図・画像・コンテンツブロックの縦並び強制
   ========================================================================== */

/* Mermaid図は常に縦並び */
.post-content .mermaid,
.post-content > .mermaid,
.post-content .highlight,
.post-content > .highlight,
.post-content figure,
.post-content > figure,
.post-content img,
.post-content > img {
  display: block !important;
  width: 100%;
  max-width: 100%;
  margin-left: auto;
  margin-right: auto;
}

/* 連続するMermaid図の間隔調整 */
.post-content .mermaid + .mermaid {
  margin-top: 3rem;
}

/* ==========================================================================
   コードブロック・ハイライト要素の調整
   ========================================================================== */

.post-content .highlight,
.post-content pre {
  width: 100%;
  max-width: 100%;
  overflow-x: auto;
}

/* ==========================================================================
   テーブルのレスポンシブ対応
   ========================================================================== */

.post-content table {
  display: block;
  width: 100%;
  max-width: 100%;
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
}

/* スマホでのテーブル表示 */
@media screen and (max-width: 768px) {
  .post-content table {
    font-size: 14px;
  }

  .post-content table th,
  .post-content table td {
    padding: 6px 4px;
    min-width: 60px;
  }
}

/* ==========================================================================
   画像のレスポンシブ対応
   ========================================================================== */

.post-content img {
  max-width: 100%;
  height: auto;
  display: block;
  margin: 1.5rem auto;
}

.post-content figure {
  max-width: 100%;
  margin: 2rem auto;
}

.post-content figure img {
  margin: 0 auto;
}

/* ==========================================================================
   横並びレイアウトの制御（2列まではOK、3列以上は縦並び）
   ========================================================================== */

/* flexboxで横並びになっている要素を検出して調整 */
.post-content > div[style*="display: flex"],
.post-content > div[style*="display:flex"] {
  flex-direction: column !important;
}

/* grid で3列以上の場合は縦並びに */
.post-content > div[style*="grid-template-columns"] {
  display: flex !important;
  flex-direction: column !important;
}

/* ==========================================================================
   スマホ・タブレット専用の最適化
   ========================================================================== */

/* スマホ（768px以下） */
@media screen and (max-width: 768px) {
  .post-content {
    padding: 0 1rem;
  }

  /* すべてのブロック要素を縦並びに */
  .post-content > * {
    width: 100% !important;
    max-width: 100% !important;
    margin-left: 0 !important;
    margin-right: 0 !important;
  }

  /* Mermaid図のモバイル最適化 */
  .post-content .mermaid {
    margin: 1.5rem 0;
    padding: 0.5rem;
    overflow-x: auto;
  }

  /* コードブロックの調整 */
  .post-content .highlight,
  .post-content pre {
    font-size: 12px;
    padding: 0.5rem;
  }

  /* 見出しのサイズ調整 */
  .post-content h1 {
    font-size: 28px;
  }

  .post-content h2 {
    font-size: 24px;
  }

  .post-content h3 {
    font-size: 20px;
  }

  /* 段落の調整 */
  .post-content p {
    font-size: 16px;
    line-height: 1.7;
  }
}

/* タブレット（769px - 1024px） */
@media screen and (min-width: 769px) and (max-width: 1024px) {
  .post-content {
    padding: 0 1.5rem;
  }

  /* 2列レイアウトはそのまま、3列以上は縦並び */
  .post-content > div {
    max-width: 100%;
  }

  .post-content .mermaid {
    max-width: 90%;
  }
}

/* デスクトップ（1025px以上） */
@media screen and (min-width: 1025px) {
  .post-content {
    max-width: var(--main-width, 720px);
    margin: 0 auto;
  }

  /* Mermaid図は最大幅を制限 */
  .post-content .mermaid {
    max-width: 1200px;
  }
}

/* ==========================================================================
   カードレイアウトの調整
   ========================================================================== */

/* カード要素（もしあれば） */
.post-content .card,
.post-content [class*="card"] {
  width: 100%;
  max-width: 100%;
  margin: 1rem auto;
}

/* カードが横並びにならないように */
.post-content .card + .card,
.post-content [class*="card"] + [class*="card"] {
  margin-top: 1.5rem;
}

/* ==========================================================================
   リストのレスポンシブ対応
   ========================================================================== */

.post-content ul,
.post-content ol {
  padding-left: 1.5rem;
}

@media screen and (max-width: 768px) {
  .post-content ul,
  .post-content ol {
    padding-left: 1.2rem;
  }
}

/* ==========================================================================
   引用ブロックの調整
   ========================================================================== */

.post-content blockquote {
  width: 100%;
  max-width: 100%;
  margin: 1.5rem 0;
  padding: 1rem 1.5rem;
  border-left: 4px solid var(--primary);
}

@media screen and (max-width: 768px) {
  .post-content blockquote {
    padding: 0.75rem 1rem;
    font-size: 15px;
  }
}

/* ==========================================================================
   flexbox/gridレイアウトの上書き（緊急対応）
   ========================================================================== */

/* 3つ以上の子要素を持つflexコンテナは縦並びに */
.post-content > div:has(> *:nth-child(3)) {
  flex-direction: column !important;
}

/* gridで3カラム以上は1カラムに */
.post-content > div[style*="grid"] {
  grid-template-columns: 1fr !important;
}

/* ==========================================================================
   印刷時の最適化
   ========================================================================== */

@media print {
  .post-content {
    max-width: 100%;
  }

  .post-content .mermaid {
    page-break-inside: avoid;
  }

  .post-content img,
  .post-content figure {
    page-break-inside: avoid;
  }
}
